var markers = [];var overlays = [];$( document ).ready( function() {		var sitesIcon = 'http://labs.google.com/ridefinder/images/mm_20_red.png';		var myLatlng = new google.maps.LatLng( 10.66667,122.95 );		var marker;		var map;		var mapOptions = {			zoom: 16,			center: new google.maps.LatLng( 10.66667,122.95 ),			mapTypeId: google.maps.MapTypeId.ROADMAP		};				map = new google.maps.Map(document.getElementById('map_canvas'), mapOptions);				window.mapster = map; 				google.maps.event.addListener( map, 'dragend', function() {						// 3 seconds after the center of the map has changed, pan back to the			// marker.			console.log( map.center );			var i = 0;			var coords_ = [];						for( coords in map.center ){				i++;				coords_[i] = map.center[ coords];				if( i == 2 ) break;			}						var lat = coords_[1];			var lon = coords_[2];			var center = new google.maps.LatLng( lat, lon )			getPlaces( lat, lon );				});			$( '.setLocation' ).live( 'click', function(){		var address = $( '#address' ).val();		geocoder = new google.maps.Geocoder();					/* Geolocate address */		 geocoder.geocode( {'address': address }, function(results, status) {		 		 console.log( results[0] );		 			$( '#address' ).val( results[0].formatted_address );								/*shwo marker*/			getPlaces( results[0].geometry.location.Xa, results[0].geometry.location.Ya  );						/*set center*/			window.mapster.setCenter( new google.maps.LatLng( results[0].geometry.location.Xa, results[0].geometry.location.Ya ))					 })				})		$( '.zoomify' ).live( 'click', function() {			var latlang = $( this ).attr( 'id' );				var latlngG = latlang.split( ',' )				window.mapster.setCenter( new google.maps.LatLng( latlngG[0], latlngG[1] ) )				window.mapster.setZoom( 20 );			})			})function getPlaces( lat , lon ) {			var site_url = 'getJson.php';				var defaults = ({			location: lat +","+ lon,			radius: '500',			types: '',			QAname: '',			sensor: true,			key: 'AIzaSyANgemxn24jCyKw1VzHNkN2FcumirQPeVg'		});						deleteOverlays();				// set map zoom 		window.mapster.setZoom( 15 );				$.ajax({				url: site_url,				data: defaults,				dataType: 'json',				type: 'get',				success: $.proxy( function( response ) {												console.log( response )						var list_display = $( '.form' ).find( 'ul' );												$( list_display ).html( '' );												$.each( response.results, function( k,v ) {													var myLatlng = new google.maps.LatLng( v.geometry.location.lat, v.geometry.location.lng );														var infowindow = new google.maps.InfoWindow({								content:  "<img style='float: left' width='50' src='"+v.icon+"' /><p>"+v.name+"<br /></p><p>"+v.vicinity+"</p>"							});														$( list_display ).append( '<li class="zoomify" id="'+v.geometry.location.lat+','+v.geometry.location.lng+'">"<img style="float: left" width="20" src="'+v.icon+'" /> '+v.name+'</li>' );														var marker = new google.maps.Marker({								position: myLatlng,								map: window.mapster,								animation: google.maps.Animation.DROP,								title: v.name							});														google.maps.event.addListener( marker, 'click', function() {								infowindow.open( window.mapster, marker );							});														markers.push(marker)													});										}, this ),				error: function( a, b ){					console.log( a );					console.log( b );				}			}); 						console.log( defaults )}function setAllMap(map) {	for (var i = 0; i < markers.length; i++) {	  markers[i].setMap(map);	}}	  function clearOverlays() {	setAllMap(null);}function deleteOverlays() {	clearOverlays();	markers = [];}function setMarker( contentString, latLang, map ) {		var infowindow = new google.maps.InfoWindow({		content: contentString	});	var marker = new google.maps.Marker({		position: latLang,		map: map,		animation: google.maps.Animation.DROP,		title: 'Uluru (Ayers Rock)'	});							google.maps.event.addListener(marker, 'click', function() {	  infowindow.open(map,marker);	});	}function closeAllInfoWindow(){           for(var i=0; i<10; i++){                infoWindowList[i].close();           }     }        function toggleBounce() {  if (marker.getAnimation() != null) {  		marker.setAnimation(null);  } else {  		marker.setAnimation(google.maps.Animation.BOUNCE);  }  }function setNotification( icon, title, message ){		if (window.webkitNotifications.checkPermission() == 0) { // 0 is PERMISSION_ALLOWED		// function defined in step 2		notification_test = window.webkitNotifications.createNotification(		 icon, title, message );		notification_test.ondisplay = function() {  };		notification_test.onclose = function() {  };		notification_test.show();	  } else {		window.webkitNotifications.requestPermission();	  }}