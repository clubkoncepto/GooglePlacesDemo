var markers = [];var overlays = [];$( document ).ready( function() {		var sitesIcon = 'http://labs.google.com/ridefinder/images/mm_20_red.png';		var myLatlng = new google.maps.LatLng( 10.66667,122.95 );		var marker;		var map;		var mapOptions = {			zoom: 12,			center: new google.maps.LatLng( 10.66667,122.95 ),			mapTypeId: google.maps.MapTypeId.ROADMAP		};				map = new google.maps.Map(document.getElementById('map_canvas'), mapOptions);				window.mapster = map; 				google.maps.event.addListener( map, 'dragend', function() {			// 3 seconds after the center of the map has changed, pan back to the			// marker.			console.log( map.center );			var i = 0;			var coords_ = [];						for( coords in map.center ){				i++;				coords_[i] = map.center[ coords];				if( i == 2 ) break;			}						var lat = coords_[1];			var lon = coords_[2];			var center = new google.maps.LatLng( lat, lon );			var name = $( '#name' ).val();			var radius = $( '#radius' ).val();								getPlaces( lat, lon, name, radius );				});			$( '#locator' ).live( 'submit', function( event ){		window.cityCircle.setMap( null );		event.preventDefault();		var address = $( '#address' ).val();		var name = $( '#name' ).val();		var radius = $( '#radius' ).val();				var data = $( this ).serialize();				geocoder = new google.maps.Geocoder();					/* Geolocate address */		 geocoder.geocode( {'address': address }, function(results, status) {						console.log( results[0] );						var dinates_ = [];			var i = 0;						for( dinates in results[0].geometry.location ){				i++;				dinates_[i] = results[0].geometry.location[dinates];				if( i == 2 ) break;			}		 			$( '#address' ).val( results[0].formatted_address );								console.log(dinates_[1]);					/*shwo marker*/			getPlaces( dinates_[1], dinates_[2], name, radius  );						/*set center*/			window.mapster.setCenter( new google.maps.LatLng(  dinates_[1], dinates_[2] ) );					 })		 		 		})		 $( '#radius' ).change( function() {		var circum = parseInt( $( this ).val() );		$( '.range_result' ).html( circum + " km Circumference" );		// window.mapster.setZoom( parseInt(zoom) );					if( circum < 500 ) {			window.mapster.setZoom( parseInt( 15 ) );		}else if ( circum >= 500 && circum <= 1000   ) {			window.mapster.setZoom( parseInt( 14 ) );		}else if ( circum >= 1001 && circum <= 2000   ) {			window.mapster.setZoom( parseInt( 13 ) );		}else if ( circum >= 2001 && circum <= 3000   ) {			window.mapster.setZoom( parseInt( 12 ) );		}else if ( circum >= 3001 && circum <= 4000   ) {			window.mapster.setZoom( parseInt( 11 ) );		}else if ( circum >= 4001 && circum <= 5000   ) {			window.mapster.setZoom( parseInt( 10 ) );		}			 })				$( '.zoomify' ).live( 'click', function() {			var latlang = $( this ).attr( 'id' );				var latlngG = latlang.split( ',' )				window.mapster.setCenter( new google.maps.LatLng( latlngG[0], latlngG[1] ) )				window.mapster.setZoom( 20 );			})			})/* var populationOptions = {			  strokeColor: "#FF0000",			  strokeOpacity: 0.8,			  strokeWeight: 2,			  fillColor: "#FF0000",			  fillOpacity: 0.35,			  map: map,			  center: myLatlng,			  radius: parseInt( radius * 2)			};window.cityCircle = new google.maps.Circle( populationOptions );*/function getPlaces( lat , lon, name, radius ) {				radius == 'undefined' ? radius = '500': radius = radius;		name == 'undefined' ? name = '': name = name;		var map = window.mapster;		var myLatlng = new google.maps.LatLng( lat, lon );						var site_url = 'getJson.php';			var defaults = ({			location: lat +","+ lon,			radius: radius,			types: '',			name: name,			sensor: true,			key: 'AIzaSyBlP9FX_G5yw3mnexpV0y0r7naEGN0p08c'		});				console.log( defaults );		$( '.loading' ).html( 'Finding Location' );		deleteOverlays();		$( '.loading' ).fadeIn();				$.ajax({				url: site_url,				data: defaults,				dataType: 'json',				type: 'get',				success: $.proxy( function( response ) {												console.log( response )						var list_display = $( '.form' ).find( 'ul' );												$( list_display ).html( '' );												if ( response.status == 'ZERO_RESULTS' ) { $( list_display ).append( '<li>No Search Result</li>' ) }												$.each( response.results, function( k,v ) {													var myLatlng = new google.maps.LatLng( v.geometry.location.lat, v.geometry.location.lng );														var infowindow = new google.maps.InfoWindow({								content:  "<img style='float: left' width='50' src='"+v.icon+"' /><p>"+v.name+"<br /></p><p>"+v.vicinity+"</p>"							});														$( list_display ).append( '<li class="zoomify" id="'+v.geometry.location.lat+','+v.geometry.location.lng+'">"<img style="float: left" width="20" src="'+v.icon+'" /> '+v.name+'</li>' );														var marker = new google.maps.Marker({								position: myLatlng,								map: window.mapster,								animation: google.maps.Animation.DROP,								title: v.name							});														google.maps.event.addListener( marker, 'click', function() {								infowindow.open( window.mapster, marker );							});														markers.push(marker)							$( '.loading' ).fadeOut();							});										}, this ),				error: function( a, b ){					if( b  == 'parsererror') {						$( '.loading' ).html( "Can't find location. <br />Why not change the keyword and try again." )					}				}			});}function setAllMap(map) {	for (var i = 0; i < markers.length; i++) {	  markers[i].setMap(map);	}}	  function clearOverlays() {	setAllMap(null);}function deleteOverlays() {	clearOverlays();	markers = [];}function setMarker( contentString, latLang, map ) {		var infowindow = new google.maps.InfoWindow({		content: contentString	});	var marker = new google.maps.Marker({		position: latLang,		map: map,		animation: google.maps.Animation.DROP,		title: 'Uluru (Ayers Rock)'	});							google.maps.event.addListener(marker, 'click', function() {	  infowindow.open(map,marker);	});	}function closeAllInfoWindow(){           for(var i=0; i<10; i++){                infoWindowList[i].close();           }     }        function toggleBounce() {  if (marker.getAnimation() != null) {  		marker.setAnimation(null);  } else {  		marker.setAnimation(google.maps.Animation.BOUNCE);  }  }function setNotification( icon, title, message ){		if (window.webkitNotifications.checkPermission() == 0) { // 0 is PERMISSION_ALLOWED		// function defined in step 2		notification_test = window.webkitNotifications.createNotification(		 icon, title, message );		notification_test.ondisplay = function() {  };		notification_test.onclose = function() {  };		notification_test.show();	  } else {		window.webkitNotifications.requestPermission();	  }}